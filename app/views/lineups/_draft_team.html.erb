<div class='jumbotron team teamDraft'>
  <div class='contestlive'>
    <strong> Contest Live In</strong>
    <%= countdown_tag @contest.start_at %>
  </div>
  <h1>Draft Your Team</h1>

  <p>
    Choose from the available players below, and submit your team.
    <br/>
    You can edit your team at any time until the game starts.
  </p>

  <p>
    <strong class='green'>Full Contest Rules & Prizes »</strong>
  </p>

  <h1 class="bold"><%= @contest.sport %></h1>
  <h4>(Mon-Thurs) [5 step 1 Tix Gtd.]</h4>

  <h1 class='bold'> <%= number_to_currency @contest.prize, precision: 0 %> Prize Pool</h1>
</div>

<p class='timingschedule'>
  <strong>Start Time:</strong>
  October 14,2013 at 8:40pm EST
  <strong>Entry Fee:</strong>
  <%= contest_entry_fee @contest %>
  <strong>Entries:</strong>
  <span class='green'>564/Uni »</span>
</p>

<div class='welcomeNote'>SELECT THE BEST TEAM WITHOUT EXCEEDING THE SALARY CAP.</div>
<div class='col-md2'>
  <h2>AVAILABLE PLAYERS</h2>
  <ul class='dropdownsport'>
    <li>
      <div class='styled-select'>

        <%= select :filter, :player, options_for_select(collection_for_sports_options), {include_blank: "ALL GAMES"} %>

      </div>
    </li>
    <li>
      <input placeholder="Search" type="text"/>
    </li>
  </ul>

  <ul id='filterSport' class='nav nav-tabs tabs'>
    <li class="active">
      <a data-toggle="tab" href="#ALL">ALL</a>
    </li>
    <% @positions.each do |position| %>
        <li>
          <%= link_to position.name, "##{position.name} ", data: {toggle: 'tab'} %>
        </li>
    <% end %>
 </ul>

  <div class='tab-content same-height'>
    <div class='tab-pane active' id="ALL">
      <table class='tab lineup table sortable striped-grid'>
        <thead>
        <tr>
          <th>POS</th>
          <th data-defaultsort="asc">PLAYER</th>
          <th>OPP</th>
          <th>SALARY</th>
          <th>FPPG</th>
          <th>&nbsp;</th>
        </tr>
        </thead>
        <tbody>
          <%= render partial: 'lineups/lineup_player', collection: Player.eager_load(:sport_position).all, as: :player %>
        </tbody>
      </table>
    </div>

    <% @positions.each.each do |position| %>
        <div class='tab-pane' id="<%= position.name %>">
          <table class='tab lineup table sortable striped-grid'>
            <thead>
            <tr>
              <th>POS</th>
              <th data-defaultsort="asc">PLAYER</th>
              <th>OPP</th>
              <th>SALARY</th>
              <th>FPPG</th>
              <th>&nbsp;</th>
            </tr>
            </thead>
            <tbody>
              <%= render partial: 'lineups/lineup_player', collection: position.players, as: :player %>
            </tbody>
          </table>
        </div>
    <% end %>
    <p class='green'>Export to CSV »</p>

  </div>
</div>
<%= form_for @lineup do |f| %>
    <div class='col-md2'>
      <h2>LINEUP</h2>

      <div class='col-lg-6'>
        <h4>
          <strong> AVG. REM./PLAYER:</strong>
          <span id='avg-rem-salary' class="currency">
            <%= number_to_currency consumed_salary(@lineup), precision: 0 %>
          </span>
        </h4>
      </div>
      <div class='col-lg-6'>
        <h4>
          <strong> REM./SALARY:</strong>
          <span id='contest-salary-cap' class="currency" data-salary=<%= @contest.salary_cap %>>
             <%= number_to_currency @contest.salary_cap - consumed_salary(@lineup), precision: 0 %>
          </span>
        </h4>
      </div>

      <table class='tab same-height striped-grid'>
        <thead>
        <tr>
          <th>POS</th>
          <th>PLAYER</th>
          <th>OPP</th>
          <th>SALARY</th>
          <th>FPPG</th>
          <th>&nbsp;</th>
        </tr>
        </thead>
        <tbody>
        <%= f.fields_for :lineup_spots do |spot_form| %>
            <% spot = spot_form.object %>
            <% position = spot.sport_position %>
            <%= content_tag :tr, id: dom_id(spot), class: 'lineup-spot', data: {sport_position_name: position.name, player_id: spot.player_id, spot: spot.spot} do %>
              <td>
                <strong><span><%= position.name %> </span></strong>
                <%= spot_form.hidden_field :sport_position_id %>
                <%= spot_form.hidden_field :spot %>
              </td>
              <td class='player val'>
                <span><%= player_field_or_nbsp spot, :name %></span>
                <%= spot_form.hidden_field :player_id %>
              </td>
              <td class='opp val'>
                <span>&nbsp;</span>
              </td>
              <td class='salary val'>
                <span class="currency">&nbsp;</span>
              </td>
              <td class='fppg val'>
                <span>&nbsp;</span>
              </td>
              </td>
              <td class='action-icon'><%= link_to 'x', '#_', class: 'remove-from-lineup', data: {lineup_spot: spot.spot} %> </td>
            </tr>
          <% end %>
        <% end %>
        <tr>
          <td>
            <strong>ALL</strong>
          </td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
        </tr>
        </tbody>
      </table>
      <%= link_to 'Import »', '#_', class: 'green', id: 'import-lineups' %>
      <%= link_to 'Clear »', '#_', class: 'green', id: 'clear-lineups', confirm: "are you sure to clear lineups?" %>
    </div>

    <%= f.hidden_field :sport %>
    <%= f.hidden_field :contest_id_to_enter %>
    <div class='clear'> &nbsp;</div>
    <div class='submitTeam'>
      <%= f.submit 'SUBMIT TEAM', disable_with: 'Please wait...' %>
    </div>
<% end %>

